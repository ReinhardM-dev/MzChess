

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>chessMainWindow &mdash; MzChess V2.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MzChess
          

          
          </a>

          
            
            
              <div class="version">
                V2.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../gui.html">Chess GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysePosition.html">Position-Analyser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../buildFen.html">FEN-Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utilities</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MzChess</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>chessMainWindow</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for chessMainWindow</h1><div class="highlight"><pre>
<span></span><span class="k">try</span><span class="p">:</span>
 <span class="kn">from</span> <span class="nn">PyQt6</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtCore</span>
 <span class="kn">from</span> <span class="nn">PyQt6.QtGui</span> <span class="kn">import</span> <span class="n">QAction</span>
 <span class="kn">from</span> <span class="nn">PyQt6</span> <span class="kn">import</span> <span class="n">uic</span>
 <span class="kn">import</span> <span class="nn">PyQt6.QtSvgWidgets</span>
 <span class="kn">import</span> <span class="nn">PyQt6.QtCharts</span>
<span class="k">except</span><span class="p">:</span>
 <span class="k">try</span><span class="p">:</span>
  <span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtCore</span>
  <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QAction</span>
  <span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">uic</span>
  <span class="kn">import</span> <span class="nn">PyQt5.QtSvg</span>
  <span class="kn">import</span> <span class="nn">PyQt5.QtChart</span>
 <span class="k">except</span><span class="p">:</span>
  <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span><span class="s1">&#39;Neither the required PyQt6 nor PyQt5 modules completely installed&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1"># We must create the QtWidgets.QApplication here to avoid Sphinx issues</span>
<span class="n">qApp</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Main Window of the Chess GUI</span>
<span class="sd">================================</span>
<span class="sd">|MainWindow| </span>

<span class="sd">The main Window consists of 4 parts:</span>

<span class="sd"> * On the left, the *game board* with the *material* and *next turn* labels. The *next turn* may 4 colors ``white``, ``black``, ``red`` (mate), ``yellow`` (draw)</span>
<span class="sd"> * On the right, the TAB widget with the</span>
<span class="sd">    </span>
<span class="sd">    * *Game* tree widget displaying the body of the actual game</span>
<span class="sd">    * *Headers* list widget displaying the header of the actual game</span>
<span class="sd">    * *Database* list widget displaying all loaded games</span>
<span class="sd">    * *Score* plot displaying engine and material scores</span>
<span class="sd">    * *Log* edit displaying communication with the engine in use</span>
<span class="sd">    </span>
<span class="sd"> * On the bottom, the status bar with the labels</span>

<span class="sd">    * *info/error* displaying information or errors</span>
<span class="sd">    * *engine* displaying the engine in use</span>
<span class="sd">    * *hint/score* displaying the hint and score computed by the engine</span>
<span class="sd">    * *ECO code* displaying the eco code of the current opening, the hint shows the full opening string</span>
<span class="sd">    * *square* displaying the square under the cursor within the board</span>

<span class="sd">Main Window Menu</span>
<span class="sd">================================</span>
<span class="sd">On the top, the menu with</span>

<span class="sd"> * *File* menu handling files in the Portable Game Notation (`PGN`_) and pickled PGN (*PPNG*) formats</span>

<span class="sd">    * *Encoding* sub-menu to set encoding for opening/saveing PNG-format</span>
<span class="sd">    * *Open DB ...* action to open a PPGN- or PGN-file and replace the current database</span>
<span class="sd">    * *Recent* sub-menu with the recent PPGN- or PGN-files</span>
<span class="sd">    * *Append to DB ...* action to open a PPGN- or PGN-file and append to the current database</span>
<span class="sd">    * *Save DB ...* action to save the whole database as a PPGN- or PGN-file </span>
<span class="sd">    * *Save Game ...* action to save the actual game as a PGN-file </span>
<span class="sd">    * *Exit* action to terminate the GUI</span>

<span class="sd"> * *Edit* menu with obvious functionality with the exception of</span>
<span class="sd"> </span>
<span class="sd">    * *Copy Game*, i.e. the actual game PGN is copied to the clipboard</span>
<span class="sd">    * *Copy FEN*, i.e. the actual position is copied to the clipboard</span>
<span class="sd">    * *Promote/Demote Variant* promote/demote the variant selected in the Game TAB</span>
<span class="sd">    * *Promote Variant to Main* promote the variant selected in the Game TAB to mainline</span>
<span class="sd">    * *Delete Variant* delete the variant selected in the Game TAB</span>
<span class="sd">    * *Undo Current Action* deletes the end move of a sequence (main line or variant)</span>

<span class="sd"> * *Database* menu with obvious functionality with the exception of</span>
<span class="sd"> </span>
<span class="sd">    * *Remove Games* removes selected games in the *Database* TAB</span>
<span class="sd">    * *Move Games&gt;Up/Down*  moves a selected game up and down in the *Database*</span>
<span class="sd">    * *Paste Game*, i.e. the actual game PGN from the clipboard and added to the *Database*</span>
<span class="sd">    * *Paste FEN*, i.e. the actual position is pasted from the clipboard and added to the *Database*</span>

<span class="sd"> * *Game* menu with obvious functionality with the exception of</span>
<span class="sd"> </span>
<span class="sd">    * *Select Header Elements ...* opens a dialog to add/remove header elements according to the `PGN`_ standard</span>
<span class="sd">    * *Show Move Options* shows by left-button selecting a square the weighted options </span>
<span class="sd">    * *Warn of Danger* shows squares attacked by the opponent </span>

<span class="sd"> * *Engine* menu for handling Universal Chess Interface (`UCI`_) engines with</span>
<span class="sd"> </span>
<span class="sd">    * *Select Engine* sub-menu to select the engine for hints/scores and annotations</span>
<span class="sd">    * *Search Depth* sub-menu to set the search depth of the selected engine</span>
<span class="sd">    * *Score Current Move* annotates the move leading to actual position</span>
<span class="sd">    * *Annotate All* annotates the actual game or variant</span>
<span class="sd">    * *# Annotations* defines the number of variants to be suggested in case of a blunder</span>
<span class="sd">    * *Blunder Limit* defines the limit to add a variant</span>
<span class="sd">    * *Annotate Variants* defines the number of half moves (PLY) to be shown in variants </span>
<span class="sd">    * *Show Scores* toggle actions enables the *score* part of the *hint/score* label of the status bar</span>
<span class="sd">    * *Show Hints* toggle actions enables the *hint* part of the *hint/score* label of the status bar</span>
<span class="sd">    * *Configure ...* opens a dialog to add/remove/configure engines</span>
<span class="sd">    * *Debug* logs the communication with engine in the *Log* TAB</span>

<span class="sd">Keyboard and Mouse Contol</span>
<span class="sd">================================</span>

<span class="sd">To allow for a user-friendly usage, the game can be controlled by keyboard and/or mouse:</span>

<span class="sd">.. csv-table:: Game Control by Keyboard/Mouse/Mouse Wheel</span>
<span class="sd">   :header: &quot;Key/Wheel&quot;, &quot;Board&quot;, &quot;Game-TAB&quot;, &quot;Description&quot;</span>
<span class="sd">   :widths: 30, 10, 10, 50</span>
<span class="sd">   </span>
<span class="sd">   :kbd:`up` | :kbd:`scroll-up`       , :kbd:`✔`, :kbd:`✔`, goto last move</span>
<span class="sd">   :kbd:`down` | :kbd:`scroll-down`, :kbd:`✔`, :kbd:`✔`, goto next move</span>
<span class="sd">   :kbd:`left`                               ,              , :kbd:`✔`, step into variant</span>
<span class="sd">   :kbd:`right`                             ,              , :kbd:`✔`, step out of a variant</span>
<span class="sd">   :kbd:`home`                            ,              , :kbd:`✔`, goto initial move</span>
<span class="sd">   :kbd:`end`                              ,              , :kbd:`✔`, goto end-of-game</span>
<span class="sd">   :kbd:`mouse-left-press`            , :kbd:`✔`,              , begin move</span>
<span class="sd">   :kbd:`mouse-left-release`          , :kbd:`✔`,              , end move</span>
<span class="sd">   :kbd:`Control-P`                      ,              , :kbd:`✔`, promote variant</span>
<span class="sd">   :kbd:`Control-D`                      ,              , :kbd:`✔`, demote variant</span>
<span class="sd">   :kbd:`Control-R`                      ,              , :kbd:`✔`, remove variant</span>
<span class="sd">   :kbd:`Control-M`                      ,              , :kbd:`✔`, promote variant to mainline</span>
<span class="sd">   :kbd:`Control-W`                      ,              , :kbd:`✔`, toggle warn of danger</span>

<span class="sd">In addition, several *standard* key strokes are supported:</span>

<span class="sd">.. csv-table:: Other Key-Codes</span>
<span class="sd">   :header: &quot;Key&quot;, &quot;Description&quot;</span>
<span class="sd">   :widths: 30, 50</span>

<span class="sd">   :kbd:`Control-Z`                       , undo last move</span>
<span class="sd">   :kbd:`Control-F`                       , flip board</span>
<span class="sd">   :kbd:`Control-C`                       , copy game (PGN) to clipboard</span>
<span class="sd">   :kbd:`Control-V`                       , paste game (PGN) from clipboard</span>
<span class="sd">   :kbd:`Control-Shift-C`               , copy position (FEN) to clipboard</span>
<span class="sd">   :kbd:`Control-Shift-V`               , paste position (FEN) from clipboard</span>

<span class="sd">.. |MainWindow| image:: mainWindow.png</span>
<span class="sd">  :width: 800</span>
<span class="sd">  :alt: Main Window</span>
<span class="sd">.. _PGN: https://github.com/fsmosca/PGN-Standard</span>
<span class="sd">.. _UCI: http://wbec-ridderkerk.nl/html/UCIProtocol.html</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">configparser</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))))</span>

<span class="kn">import</span> <span class="nn">chess</span><span class="o">,</span> <span class="nn">chess.pgn</span>
<span class="kn">import</span> <span class="nn">MzChess</span>
<span class="kn">from</span> <span class="nn">MzChess</span> <span class="kn">import</span> <span class="n">read_game</span>

<span class="kn">import</span> <span class="nn">AboutDialog</span>

<div class="viewcode-block" id="ChessMainWindow"><a class="viewcode-back" href="../chessMainWindow.html#chessMainWindow.ChessMainWindow">[docs]</a><span class="k">class</span> <span class="nc">ChessMainWindow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">):</span>
 <span class="n">logSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
 <span class="n">notifySignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
 <span class="n">notifyGameSelectedSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
 <span class="n">notifyGameListHeaderChangedSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
 <span class="n">notifyGameListChangedSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>
 <span class="n">notifyGameHeadersChangedSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Headers</span><span class="p">)</span>

 <span class="n">notifyGameNodeSelectedSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">GameNode</span><span class="p">)</span>
 <span class="n">notifyGameNodeChangedSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">GameNode</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
 <span class="n">notifyGameChangedSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Game</span><span class="p">)</span>
 <span class="n">notifyNewGameNodeSignal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">GameNode</span><span class="p">)</span>
 <span class="n">hintDict</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;None&#39;</span> <span class="p">:</span>  <span class="s1">&#39;0&#39;</span><span class="p">,</span>  <span class="s1">&#39;White&#39;</span> <span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>  <span class="s1">&#39;Black&#39;</span> <span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span>  <span class="s1">&#39;All&#39;</span> <span class="p">:</span> <span class="s1">&#39;3&#39;</span> <span class="p">}</span>
 <span class="n">hintList</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;White&#39;</span><span class="p">,</span>  <span class="s1">&#39;Black&#39;</span><span class="p">,</span>  <span class="s1">&#39;All&#39;</span> <span class="p">]</span>
 <span class="n">fileDialogOptions</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">Option</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
 <span class="n">fileDirectory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
 <span class="n">intRe</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[+-]?[1-9][0-9]*$&quot;</span><span class="p">)</span>
 <span class="n">boolRe</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(True|False)$&quot;</span><span class="p">)</span>

 <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="nb">super</span><span class="p">(</span><span class="n">ChessMainWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
  <span class="n">MzChess</span><span class="o">.</span><span class="n">installLeipFont</span><span class="p">()</span>
  <span class="n">uic</span><span class="o">.</span><span class="n">loadUi</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileDirectory</span><span class="p">,</span> <span class="s1">&#39;chessMainWindow.ui&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
  <span class="c1"># self.setupUi(self)</span>

  <span class="n">icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">()</span>
  <span class="n">icon</span><span class="o">.</span><span class="n">addPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileDirectory</span><span class="p">,</span><span class="s1">&#39;schach.png&#39;</span><span class="p">)),</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">Normal</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">Off</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
  
  <span class="bp">self</span><span class="o">.</span><span class="n">pgm</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="vm">__name__</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">__version__</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">dateString</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">__date__</span>
  
  <span class="c1"># self.helpIndex = QtCore.QUrl.fromLocalFile(os.path.join(os.path.dirname(self.fileDirectory), &#39;doc_build&#39;, &#39;html&#39;, &#39;index.html&#39;))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">helpIndex</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QUrl</span><span class="p">(</span><span class="s1">&#39;https://reinhardm-dev.github.io/MzChess&#39;</span><span class="p">)</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">ecoDB</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">ECODatabase</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">ecoFen2IdDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoDB</span><span class="o">.</span><span class="n">fen2Id</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QToolBar</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionSaveDB</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_DialogSaveButton</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionAddGame</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_FileIcon</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionFlipBoard</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_BrowserReload</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionNextMove</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_ArrowDown</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionPreviousMove</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_ArrowUp</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionNextVariant</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_ArrowForward</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionPreviousVariant</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_ArrowBack</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionPromoteVariant</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_MediaSeekBackward</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionDemoteVariant</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_MediaSeekForward</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionPromoteVariant2Main</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_MediaSkipBackward</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionDeleteVariant</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_DialogCloseButton</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionUndo</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">StandardPixmap</span><span class="o">.</span><span class="n">SP_BrowserStop</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">addToolBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="p">)</span>
  
  <span class="bp">self</span><span class="o">.</span><span class="n">gameOptions</span> <span class="o">=</span> <span class="p">{</span> 
   <span class="s1">&#39;showOptions&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionShowOptions</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> 
   <span class="s1">&#39;warnOfDanger&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionWarnOfDanger</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> 
   <span class="s1">&#39;encoding&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menuEncoding</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">encodingDict</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;UTF-8&#39;</span> <span class="p">:</span> <span class="s1">&#39;utf-8-sig&#39;</span><span class="p">,</span> <span class="s1">&#39;ISO 8859/1&#39;</span> <span class="p">:</span> <span class="s1">&#39;iso-8859-1&#39;</span><span class="p">,</span>  <span class="s1">&#39;ASCII&#39;</span> <span class="p">:</span> <span class="s1">&#39;ascii&#39;</span><span class="p">}</span>
  
  <span class="bp">self</span><span class="o">.</span><span class="n">engineOptions</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">&#39;selectedEngine&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menuSelectEngine</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> 
   <span class="s1">&#39;searchDepth&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menuSearchDepth</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
   <span class="s1">&#39;numberOfAnnotations&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menuNumberOfAnnotations</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
   <span class="s1">&#39;annotateVariants&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menuAnnotateVariants</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> 
   <span class="s1">&#39;showScores&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionShowScores</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> 
   <span class="p">}</span>
  
  <span class="c1">#  &#39;blunderLimit&#39; : (self.menuBlunderLimit, -float(&#39;inf&#39;)), </span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListHeaders</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span>  <span class="s1">&#39;White&#39;</span><span class="p">,</span>  <span class="s1">&#39;Black&#39;</span><span class="p">,</span>  <span class="s1">&#39;Result&#39;</span><span class="p">]</span>
  
  <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">eventList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">siteList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">playerList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">optionalHeaderItems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">hintEngine</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">mateScore</span> <span class="o">=</span> <span class="mi">100</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">debugEngine</span> <span class="o">=</span> <span class="kc">False</span>
  
  <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settingsDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;AppData&#39;</span><span class="p">,</span> <span class="s1">&#39;Roaming&#39;</span><span class="p">,</span> <span class="s1">&#39;MzChess&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settingsDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;.config&#39;</span><span class="p">,</span> <span class="s1">&#39;MzChess&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsDir</span><span class="p">):</span>
   <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsDir</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settingsFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsDir</span><span class="p">,</span> <span class="s1">&#39;settings.ini&#39;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">recoverFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsDir</span><span class="p">,</span> <span class="s1">&#39;recover.ppgn&#39;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">(</span><span class="n">delimiters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;=&#39;</span><span class="p">],</span> <span class="n">allow_no_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">eventList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">siteList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">playerList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">optionalHeaderItems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsFile</span><span class="p">):</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsFile</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">loadEngineSettings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
   <span class="k">if</span> <span class="s1">&#39;Recent&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">recentDB</span><span class="p">,</span> <span class="n">enc</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Recent&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
     <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">recentDB</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span><span class="p">[</span><span class="n">recentDB</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span>
   <span class="k">if</span> <span class="s1">&#39;GameListHeaders&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gameListHeaders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s1">&#39;GameListHeaders&#39;</span><span class="p">)</span>
   <span class="k">if</span> <span class="s1">&#39;Events&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eventList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s1">&#39;Events&#39;</span><span class="p">)</span>
   <span class="k">if</span> <span class="s1">&#39;Sites&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">siteList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s1">&#39;Sites&#39;</span><span class="p">)</span>
   <span class="k">if</span> <span class="s1">&#39;Players&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">playerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s1">&#39;Players&#39;</span><span class="p">)</span>
   <span class="k">if</span> <span class="s1">&#39;OptionalHeaderItems&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">optionalHeaderItems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;OptionalHeaderItems&#39;</span><span class="p">])</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;showHints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;showScores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
   
  <span class="bp">self</span><span class="o">.</span><span class="n">menuRecentDB</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">actDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">rItem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">rItem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">rItem</span><span class="p">):</span>
     <span class="k">if</span> <span class="n">actDir</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">):</span>
      <span class="n">actDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">rItem</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">menuRecentDB</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">rItem</span><span class="p">)</span>
  
  <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">actDir</span><span class="p">)</span>
  
  <span class="bp">self</span><span class="o">.</span><span class="n">aboutDialog</span> <span class="o">=</span> <span class="n">AboutDialog</span><span class="o">.</span><span class="n">AboutDialog</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">aboutDialog</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
   <span class="n">pgm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgm</span><span class="p">,</span> 
   <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> 
   <span class="n">dateString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dateString</span><span class="p">)</span>

  <span class="n">sbText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">font</span><span class="p">()</span>
  <span class="n">sbText</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
  
  <span class="bp">self</span><span class="o">.</span><span class="n">moveLabel</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">moveLabel</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">sbText</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">moveLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">moveLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Total Moves/Half-moves since the last capture or pawn move&quot;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moveLabel</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">infoLabel</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignLeft</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">sbText</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="p">,</span> <span class="mi">130</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">engineLabel</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">engineLabel</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">sbText</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">engineLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">engineLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Engine in use&quot;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engineLabel</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">hintLabel</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">hintLabel</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">sbText</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">hintLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">hintLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Best move/Score[Pawns]&quot;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hintLabel</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">ecoLabel</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">ecoLabel</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">sbText</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">ecoLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ecoLabel</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">squareLabel</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">squareLabel</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">sbText</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">squareLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">squareLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Position&quot;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">squareLabel</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">itemSelector</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">ItemSelector</span><span class="p">(</span><span class="s1">&#39;Header Elements (without 7-tag roster)...&#39;</span><span class="p">,</span> <span class="n">pointSize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
  
  <span class="bp">self</span><span class="o">.</span><span class="n">loadOptionDict</span><span class="p">(</span><span class="s1">&#39;Menu/Game&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameOptions</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">resetSelectEngine</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">loadOptionDict</span><span class="p">(</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engineOptions</span><span class="p">)</span>
  <span class="n">blunderLimit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;blunderLimit&#39;</span><span class="p">,</span> <span class="s1">&#39;-inf&#39;</span><span class="p">))</span>
  <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBlunderLimit</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="n">tList</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
   <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">tList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">blunderLimit</span> <span class="o">==</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span> \
                        <span class="ow">or</span>  <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">blunderLimit</span> <span class="o">==</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">tList</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
  <span class="n">hintValue</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;showHints&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="k">for</span> <span class="n">actAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuShowHints</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="k">if</span> <span class="n">actAction</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">hintList</span><span class="p">[</span><span class="n">hintValue</span><span class="p">]:</span>
    <span class="n">actAction</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListTableView</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">notifyDoubleClickSignal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameSelectedSignal</span><span class="p">,</span> 
                                          <span class="n">notifyHeaderChangedSignal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameListHeaderChangedSignal</span><span class="p">,</span> 
                                          <span class="n">notifyListChangedSignal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameListChangedSignal</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListTableView</span><span class="o">.</span><span class="n">gameHeaderKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListHeaders</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameSelectedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameSelected</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameListHeaderChangedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameListHeaderChanged</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameListChangedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">pgnFile</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListFile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameFile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Game</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_addGame</span><span class="p">(</span><span class="n">game</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">isNew</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameSelected</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 
  <span class="bp">self</span><span class="o">.</span><span class="n">gameHeaderTableView</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
       <span class="n">notifyGameHeadersChangedSignal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameHeadersChangedSignal</span><span class="p">,</span> 
       <span class="n">eventList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventList</span><span class="p">,</span> <span class="n">siteList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">siteList</span><span class="p">,</span> <span class="n">playerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerList</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameHeadersChangedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameHeadersChanged</span><span class="p">)</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
   <span class="n">notifyNewGameNodeSignal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifyNewGameNodeSignal</span><span class="p">,</span> <span class="n">notifyGameNodeSelectedSignal</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">notifyGameNodeSelectedSignal</span><span class="p">,</span> 
   <span class="n">materialLabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialLabel</span><span class="p">,</span> <span class="n">squareLabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">squareLabel</span><span class="p">,</span> 
   <span class="n">turnFrame</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">turnFrame</span><span class="p">,</span> <span class="n">hintLabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hintLabel</span><span class="p">,</span> 
   <span class="n">flipped</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notifyGameNodeSelectedSignal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameNodeChangedSignal</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notifyGameNodeSelectedSignal</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameNodeSelectedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameNodeChangedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNodeChanged</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyNewGameNodeSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newGameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyGameChangedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameChanged</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifySignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">logSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLog</span><span class="p">)</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">show_HintsScores</span><span class="p">()</span>


 <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="n">sizes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">sizes</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">setSizes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span> <span class="n">sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">height</span><span class="p">()])</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setDrawOptions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionShowOptions</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setGameNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListTableView</span><span class="o">.</span><span class="n">resetDB</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameHeaderTableView</span><span class="o">.</span><span class="n">resetGame</span><span class="p">()</span>

 <span class="k">def</span> <span class="nf">loadOptionDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">n2oDict</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">QAction</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
  <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="n">optionsDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">opt</span><span class="p">,</span> <span class="n">o2v</span> <span class="ow">in</span> <span class="n">n2oDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
   <span class="n">obj</span><span class="p">,</span> <span class="n">defValue</span> <span class="o">=</span> <span class="n">o2v</span>
   <span class="n">optionsDict</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">defValue</span>
   <span class="n">optValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">defValue</span><span class="p">)</span>
   <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">QAction</span><span class="p">):</span>
    <span class="n">optionsDict</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">optValue</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">optionsDict</span><span class="p">[</span><span class="n">opt</span><span class="p">])</span>
   <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
     <span class="n">tListString</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tListString</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">continue</span>
     <span class="n">tList</span> <span class="o">=</span> <span class="n">tListString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intRe</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">tList</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">actionValue</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tList</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
     <span class="k">elif</span> <span class="n">tList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
      <span class="n">actionValue</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span>
     <span class="k">elif</span> <span class="n">tList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
      <span class="n">actionValue</span> <span class="o">=</span> <span class="kc">None</span>
     <span class="k">else</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
       <span class="n">actionValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tList</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="k">except</span><span class="p">:</span>
       <span class="n">actionValue</span> <span class="o">=</span> <span class="n">tListString</span>
     <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">actionValue</span><span class="p">)</span> <span class="o">==</span> <span class="n">optValue</span> <span class="ow">or</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">actionValue</span><span class="p">)</span> <span class="o">==</span> <span class="n">optValue</span><span class="p">:</span>
      <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
      <span class="n">optionsDict</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">actionValue</span>
     <span class="k">else</span><span class="p">:</span>
      <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">optionsDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
   
 <span class="k">def</span> <span class="nf">resetSelectEngine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">menuSelectEngine</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
  <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuSelectEngine</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">if</span> <span class="s1">&#39;Menu/Engine&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span><span class="p">:</span>
    <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">menuSelectEngine</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">eItem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span><span class="p">:</span>
    <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuSelectEngine</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">eItem</span><span class="p">)</span>
    <span class="n">action</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">eItem</span><span class="p">:</span>
     <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

 <span class="k">def</span> <span class="nf">updateSettingsList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">valueList</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="n">firstValue</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">section</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
  <span class="n">newDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valueList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">newDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">section</span><span class="p">])</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">firstValue</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
   <span class="n">key</span> <span class="o">=</span> <span class="n">firstValue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
   <span class="n">value</span> <span class="o">=</span> <span class="n">firstValue</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">key</span> <span class="o">=</span> <span class="n">firstValue</span>
   <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="n">newDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">remove_option</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
   <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valueList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">keys</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">remove_section</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">newDict</span><span class="p">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">newDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">section</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
  <span class="k">for</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">valueList</span><span class="p">:</span>
   <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kv</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">section</span><span class="p">][</span><span class="n">kv</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">section</span><span class="p">][</span><span class="n">kv</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
  
 <span class="k">def</span> <span class="nf">saveSettings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsFile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

 <span class="c1"># --------------------------------------------------------------------------------------------------</span>
 
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">notifyError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="n">msgBox</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="p">()</span>
  <span class="n">msgBox</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
  <span class="n">msgBox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
  <span class="n">msgBox</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error ...&quot;</span><span class="p">)</span>
  <span class="n">msgBox</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

 <span class="k">def</span> <span class="nf">setInfoLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setupGameID</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">setupGameID</span><span class="p">:</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">]</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;game #</span><span class="si">{}</span><span class="s1"> of </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> moves): </span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">),</span> 
   <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">end</span><span class="p">()</span><span class="o">.</span><span class="n">board</span><span class="p">()</span><span class="o">.</span><span class="n">fullmove_number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListHeaders</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameListHeaders</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">infoLabel</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
  <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

 <span class="k">def</span> <span class="nf">setMoveLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">moveLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">fullmove_number</span><span class="p">,</span> <span class="n">board</span><span class="o">.</span><span class="n">halfmove_clock</span><span class="p">))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">moveLabel</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
  <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

 <span class="k">def</span> <span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">toLog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">uciTextEdit</span><span class="o">.</span><span class="n">moveCursor</span> <span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTextCursor</span><span class="o">.</span><span class="n">MoveOperation</span><span class="o">.</span><span class="n">End</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">uciTextEdit</span><span class="o">.</span><span class="n">insertPlainText</span> <span class="p">(</span><span class="n">msg</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">uciTextEdit</span><span class="o">.</span><span class="n">moveCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTextCursor</span><span class="o">.</span><span class="n">MoveOperation</span><span class="o">.</span><span class="n">End</span><span class="p">)</span>

 <span class="k">def</span> <span class="nf">_setIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">stdIcon</span><span class="p">,</span> <span class="n">toToolbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">()</span><span class="o">.</span><span class="n">standardIcon</span><span class="p">(</span><span class="n">stdIcon</span><span class="p">))</span>
  <span class="k">if</span> <span class="n">toToolbar</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

 <span class="k">def</span> <span class="nf">_showEcoCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gameNode</span><span class="p">,</span> <span class="n">fromBeginning</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">fromBeginning</span><span class="p">:</span>
   <span class="n">actNode</span> <span class="o">=</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">game</span><span class="p">()</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">ecoCode</span> <span class="o">=</span> <span class="s1">&#39;---&#39;</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">ecoDescription</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">actNode</span> <span class="o">=</span> <span class="n">gameNode</span>
  <span class="nb">id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="k">while</span> <span class="n">actNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="n">fen</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">actNode</span><span class="o">.</span><span class="n">board</span><span class="p">()</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
   <span class="k">if</span> <span class="n">fen</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoFen2IdDict</span><span class="p">:</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoFen2IdDict</span><span class="p">[</span><span class="n">fen</span><span class="p">]</span>
   <span class="n">actNode</span> <span class="o">=</span> <span class="n">actNode</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
  <span class="k">if</span> <span class="nb">id</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">ecoCode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoDB</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">ecoDescription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoDB</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
   <span class="n">gameNode</span><span class="o">.</span><span class="n">game</span><span class="p">()</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Opening&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoDescription</span>
   <span class="n">gameNode</span><span class="o">.</span><span class="n">game</span><span class="p">()</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;ECO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ecoCode</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">ecoLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ecoCode</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">ecoLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ecoDescription</span><span class="p">)</span>

 <span class="k">def</span> <span class="nf">_allowNewGameList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span><span class="p">:</span>
   <span class="n">rc</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
    <span class="s1">&#39;Game database not saved ...&#39;</span><span class="p">,</span> <span class="s1">&#39;Do you like to close anyway ?&#39;</span><span class="p">,</span> 
     <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">No</span><span class="p">,</span> 
     <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">No</span><span class="p">:</span>
    <span class="k">return</span> <span class="kc">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">pgnFile</span> <span class="o">=</span> <span class="kc">None</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">_addGame</span><span class="p">(</span><span class="n">game</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">isNew</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
  <span class="k">return</span> <span class="kc">True</span>

 <span class="k">def</span> <span class="nf">_addGame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">isNew</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">game</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Game</span><span class="p">()</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setGameHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optionalHeaderItems</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">())</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">())</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListTableView</span><span class="o">.</span><span class="n">setGameList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_showEcoCode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">fromBeginning</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">isNew</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="k">def</span> <span class="nf">_setGameHeader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optionalHeaderItems</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Headers</span><span class="p">:</span>
  <span class="n">selectedItems</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Headers</span><span class="p">())</span> <span class="o">+</span> <span class="n">optionalHeaderItems</span>
  <span class="n">newHeaders</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Headers</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">selectedItems</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
    <span class="n">newHeaders</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="n">el</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="n">newHeaders</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameHeaderTableView</span><span class="o">.</span><span class="n">stdKey2ValueTypeDict</span><span class="p">[</span><span class="n">el</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">optionalHeaderItems</span> <span class="o">=</span> <span class="n">optionalHeaderItems</span>
  <span class="k">return</span> <span class="n">newHeaders</span>

 <span class="c1"># ---------------------------------------------------------------------------</span>

 <span class="k">def</span> <span class="nf">openPGN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pgnFile</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">encoding</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allowNewGameList</span><span class="p">():</span>
   <span class="k">return</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Opening </span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">_</span><span class="p">,</span>  <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.ppgn&#39;</span><span class="p">:</span>
   <span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
     <span class="n">encoding</span> <span class="o">=</span> <span class="kc">None</span>
   <span class="k">except</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Cannot open PPGN file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
    <span class="k">return</span>
  <span class="k">elif</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.pgn&#39;</span><span class="p">:</span>
   <span class="k">try</span><span class="p">:</span>
    <span class="n">pgn</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span><span class="p">)</span>
   <span class="k">except</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Cannot open PGN file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
    <span class="k">return</span>
   <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
   <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">actGame</span> <span class="o">=</span> <span class="n">read_game</span><span class="p">(</span><span class="n">pgn</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">actGame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
     <span class="k">break</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">actGame</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actGame</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Failed to load game #</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
     <span class="k">return</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Cannot handle file with extension &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ext</span><span class="p">))</span>
   <span class="k">return</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>   
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;No game loaded&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recoverFile</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
   <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListTableView</span><span class="o">.</span><span class="n">setGameList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameSelected</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Recent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">pgnFile</span> <span class="p">:</span> <span class="n">encoding</span><span class="p">}</span>
  <span class="n">newRecentPGN</span> <span class="o">=</span> <span class="p">{</span><span class="n">pgnFile</span> <span class="p">:</span> <span class="n">encoding</span><span class="p">}</span>
  <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">enc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
   <span class="k">if</span> <span class="n">file</span> <span class="o">!=</span> <span class="n">pgnFile</span><span class="p">:</span>
    <span class="n">newRecentPGN</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Recent&#39;</span><span class="p">][</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span> <span class="o">=</span> <span class="n">newRecentPGN</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">menuRecentDB</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">rItem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">rItem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">rItem</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">menuRecentDB</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">rItem</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">pgnFile</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recoverFile</span><span class="p">:</span>
   <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">pgnFile</span> <span class="o">=</span> <span class="n">pgnFile</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
 
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuEncoding_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">actAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuEncoding</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="n">actAction</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Game&#39;</span><span class="p">][</span><span class="s1">&#39;encoding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionOpenDB_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">pgnFile</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;Load Game Database ...&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pickle Portable Game Notation Files (*.ppgn);;Portable Game Notation Files (*.pgn);;All Files (*)&quot;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileDialogOptions</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">pgnFile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">openPGN</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encodingDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Game&#39;</span><span class="p">][</span><span class="s1">&#39;encoding&#39;</span><span class="p">]])</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionRecoverDB_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recoverFile</span><span class="p">):</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Recovery database not existing&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">openPGN</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recoverFile</span><span class="p">)</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionGameUp_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListTableView</span><span class="o">.</span><span class="n">on_menuMoveGame_triggered</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionGameUp</span><span class="p">):</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setInfoLabel</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionCloseDB_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allowNewGameList</span><span class="p">():</span>
   <span class="k">return</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Closing database ...&#39;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

<div class="viewcode-block" id="ChessMainWindow.closeEvent"><a class="viewcode-back" href="../chessMainWindow.html#chessMainWindow.ChessMainWindow.closeEvent">[docs]</a> <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCloseEvent</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allowNewGameList</span><span class="p">():</span>
   <span class="n">ev</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hintEngine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hintEngine</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
   <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionExit_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allowNewGameList</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

 <span class="k">def</span> <span class="nf">saveDB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forceAppend</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">saveCurrent</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;No Game Database available&#39;</span><span class="p">)</span>
    <span class="k">return</span>

  <span class="k">if</span> <span class="n">forceAppend</span><span class="p">:</span>
   <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
  <span class="k">if</span> <span class="n">saveCurrent</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgnFile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="n">pgnFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgnFile</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">pgnFile</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
     <span class="s2">&quot;Save Game Database ...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListFile</span><span class="p">,</span>
     <span class="s2">&quot;Portable Game Notation Files (*.ppgn *.pgn)&quot;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileDialogOptions</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">pgnFile</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">return</span>
  <span class="n">_</span><span class="p">,</span>  <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.pgn&#39;</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Saving database to PGN file </span><span class="si">{}</span><span class="s1">.pgn ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Saving database to file </span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
  <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.ppgn&#39;</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Cannot append to PPGN file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
    <span class="k">return</span>
   <span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
     <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
   <span class="k">except</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Cannot open PPGN file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
    <span class="k">return</span>
   <span class="n">encoding</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="k">elif</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.pgn&#39;</span><span class="p">:</span>
   <span class="k">try</span><span class="p">:</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Game&#39;</span><span class="p">][</span><span class="s1">&#39;encoding&#39;</span><span class="p">]</span>
    <span class="n">pgnString</span> <span class="o">=</span> <span class="nb">str</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">game</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">:</span>
     <span class="n">exporter</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">StringExporter</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">variations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
     <span class="n">pgnString</span> <span class="o">+=</span> <span class="n">game</span><span class="o">.</span><span class="n">accept</span><span class="p">(</span><span class="n">exporter</span><span class="p">)</span>
     <span class="k">if</span> <span class="n">game</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
      <span class="n">pgnString</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span><span class="p">,</span>  <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encodingDict</span><span class="p">[</span><span class="n">encoding</span><span class="p">])</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
     <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pgnString</span><span class="p">)</span>
   <span class="k">except</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Cannot save PGN file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
    <span class="k">return</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;PGN file </span><span class="si">{}</span><span class="s1"> has improper extension (.pgn or .pgn expected)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
    <span class="k">return</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">updateSettingsList</span><span class="p">(</span><span class="s1">&#39;Recent&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">firstValue</span> <span class="o">=</span> <span class="p">(</span><span class="n">pgnFile</span><span class="p">,</span> <span class="n">encoding</span><span class="p">))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recoverFile</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
   <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">pgnFile</span> <span class="o">=</span> <span class="n">pgnFile</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionAppend2DB_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Appending database ...&#39;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveDB</span><span class="p">(</span><span class="n">forceAppend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">saveCurrent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionSaveDB_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveDB</span><span class="p">(</span><span class="n">forceAppend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">saveCurrent</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionSaveDBAs_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveDB</span><span class="p">(</span><span class="n">forceAppend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">saveCurrent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionAddGame_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Adding game #</span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_addGame</span><span class="p">()</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionRemoveGames_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListTableView</span><span class="o">.</span><span class="n">on_actionRemoveGames_triggered</span><span class="p">():</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setInfoLabel</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gameSelected</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionGameDown_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListTableView</span><span class="o">.</span><span class="n">on_menuMoveGame_triggered</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionGameDown</span><span class="p">):</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setInfoLabel</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
 
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuRecentDB_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="n">fileName</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">openPGN</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span><span class="p">[</span><span class="n">fileName</span><span class="p">])</span>
 
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuEndGame_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="n">endGame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">endGame</span><span class="o">.</span><span class="n">board</span><span class="p">()</span><span class="o">.</span><span class="n">is_game_over</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;You cannot change the game result any more&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setGameNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameChanged</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionSaveGame_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">pgnFile</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
     <span class="s2">&quot;Save Game ...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameFile</span><span class="p">,</span><span class="s2">&quot;Portable Game Notation Files (*.pgn);;All Files (*)&quot;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileDialogOptions</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">pgnFile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="k">try</span><span class="p">:</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Game&#39;</span><span class="p">][</span><span class="s1">&#39;encoding&#39;</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span>  <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encodingDict</span><span class="p">[</span><span class="n">encoding</span><span class="p">])</span>
   <span class="k">except</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Cannot open PGN file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>
    <span class="k">return</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Saving game #</span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">))</span>
   <span class="n">exporter</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">StringExporter</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">variations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
   <span class="n">pgnString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">accept</span><span class="p">(</span><span class="n">exporter</span><span class="p">)</span>
   <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pgnString</span><span class="p">)</span>
   <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">updateSettingsList</span><span class="p">(</span><span class="s1">&#39;Recent&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentPGN</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">firstValue</span> <span class="o">=</span> <span class="p">(</span><span class="n">pgnFile</span><span class="p">,</span> <span class="n">encoding</span><span class="p">))</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
   <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pgnFile</span><span class="p">))</span>

 <span class="c1"># ---------------------------------------------------------------------------</span>

<div class="viewcode-block" id="ChessMainWindow.wheelEvent"><a class="viewcode-back" href="../chessMainWindow.html#chessMainWindow.ChessMainWindow.wheelEvent">[docs]</a> <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QWheelEvent</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">wheelEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
  <span class="n">numDegrees</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">angleDelta</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">numDegrees</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">on_actionNextMove_triggered</span><span class="p">()</span>
  <span class="k">elif</span> <span class="n">numDegrees</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">on_actionPreviousMove_triggered</span><span class="p">()</span>
  <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionNextMove_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">nextMove</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setMoveLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">board</span><span class="p">())</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionPreviousMove_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">previousMove</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setMoveLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">board</span><span class="p">())</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionNextVariant_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">selectSubnodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="nb">next</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionPreviousVariant_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">selectSubnodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="nb">next</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

 <span class="nd">@staticmethod</span>
 <span class="k">def</span> <span class="nf">variantHead</span><span class="p">(</span><span class="n">gameNode</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">gameNode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">parentNode</span> <span class="o">=</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span>
  <span class="k">while</span> <span class="n">parentNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
   <span class="n">gameNode</span> <span class="o">=</span> <span class="n">parentNode</span>
   <span class="n">parentNode</span> <span class="o">=</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="n">gameNode</span><span class="p">)</span>
 
 <span class="k">def</span> <span class="nf">promoteVariant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toMain</span><span class="p">):</span>
  <span class="n">headParentNode</span><span class="p">,</span> <span class="n">headNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variantHead</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="n">oldVariations</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span>
  <span class="n">oldID</span> <span class="o">=</span> <span class="n">oldVariations</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">headNode</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">headParentNode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">oldID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;You cannot promote main line nodes&#39;</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="k">if</span> <span class="n">toMain</span> <span class="ow">or</span> <span class="n">oldID</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">moveVariant2Main</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">oldID</span><span class="p">)</span>
   <span class="n">headParentNode</span><span class="o">.</span><span class="n">promote_to_main</span><span class="p">(</span><span class="n">headNode</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">moveVariant</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">oldID</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
   <span class="n">headParentNode</span><span class="o">.</span><span class="n">promote</span><span class="p">(</span><span class="n">headNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;variations&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">oldVariations</span><span class="p">)]))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">is_mainline</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionPromoteVariant_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">promoteVariant</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionPromoteVariant2Main_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">promoteVariant</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionDemoteVariant_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">headParentNode</span><span class="p">,</span> <span class="n">headNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variantHead</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="n">oldVariations</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span>
  <span class="n">oldID</span> <span class="o">=</span> <span class="n">oldVariations</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">headNode</span><span class="p">)</span>
  <span class="n">isMainline</span> <span class="o">=</span> <span class="n">headNode</span><span class="o">.</span><span class="n">is_mainline</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">headParentNode</span> <span class="ow">is</span> <span class="kc">None</span> \
   <span class="ow">or</span> <span class="n">oldID</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;You cannot demote last line nodes&#39;</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="k">if</span> <span class="n">oldID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">moveVariant</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">oldID</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">moveVariant2Main</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">headParentNode</span><span class="o">.</span><span class="n">demote</span><span class="p">(</span><span class="n">headNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;variations&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">oldVariations</span><span class="p">)]))</span>
  <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">isMainline</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionDeleteVariant_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">headParentNode</span><span class="p">,</span> <span class="n">headNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variantHead</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">headParentNode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Use &quot;Database/Remove Games&quot; to remove a complete game&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  <span class="n">oldVariations</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span>
  <span class="n">oldID</span> <span class="o">=</span> <span class="n">oldVariations</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">headNode</span><span class="p">)</span>
  <span class="n">isMainline</span> <span class="o">=</span> <span class="n">headNode</span><span class="o">.</span><span class="n">is_mainline</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">oldID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">moveVariant</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">oldID</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">moveVariant2Main</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">headParentNode</span><span class="o">.</span><span class="n">remove_variation</span><span class="p">(</span><span class="n">headNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;variations&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">oldVariations</span><span class="p">)]))</span>
  <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">isMainline</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionDeleteAllVariants_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">is_mainline</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span>
  <span class="n">gameNodeValueDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">gameNode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">mainline</span><span class="p">():</span>
   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gameNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">gameNodeValueDict</span><span class="p">[</span><span class="n">gameNode</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">gameNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">variations</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gameNodeValueDict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">gameNodeValueList</span> <span class="o">=</span> <span class="p">[</span><span class="n">gameNodeValueDict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="nb">str</span><span class="p">())]</span>
   <span class="n">gameNodeValueList</span> <span class="o">+=</span> <span class="n">gameNodeValueDict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;nags&#39;</span><span class="p">,</span> <span class="n">gameNodeValueList</span><span class="p">))</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
 
 <span class="nd">@staticmethod</span>
 <span class="k">def</span> <span class="nf">_deleteGameNodesLenGtZero</span><span class="p">(</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">clearedAttr</span><span class="p">,</span> <span class="n">gameNodeValueDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()):</span>
  <span class="n">attrValue</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attrValue</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">gameNodeValueDict</span><span class="p">[</span><span class="n">gameNode</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrValue</span>
   <span class="nb">setattr</span><span class="p">(</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">clearedAttr</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">subNode</span> <span class="ow">in</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">variations</span><span class="p">:</span>
   <span class="n">ChessMainWindow</span><span class="o">.</span><span class="n">_deleteGameNodesLenGtZero</span><span class="p">(</span><span class="n">subNode</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">clearedAttr</span><span class="p">,</span> <span class="n">gameNodeValueDict</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">gameNodeValueDict</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionDeleteAllNAGs_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">gameNodeValueDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deleteGameNodesLenGtZero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="s1">&#39;nags&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gameNodeValueDict</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">gameNodeValueList</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">gameNodeValueDict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="nb">set</span><span class="p">()))]</span>
   <span class="n">gameNodeValueList</span> <span class="o">+=</span> <span class="n">gameNodeValueDict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;nags&#39;</span><span class="p">,</span> <span class="n">gameNodeValueList</span><span class="p">))</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionDeleteAllComments_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">gameNodeValueDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deleteGameNodesLenGtZero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">())</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gameNodeValueDict</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">gameNodeValueList</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">gameNodeValueDict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="nb">str</span><span class="p">()))]</span>
   <span class="n">gameNodeValueList</span> <span class="o">+=</span> <span class="n">gameNodeValueDict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="n">gameNodeValueList</span><span class="p">))</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionUndoCurrentMove_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="k">return</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">is_end</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Select the end of the mainline or a variant&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  <span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Cannot undo move, node owns variants&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setGameNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">removeGameNode</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">is_mainline</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">removeLastNode</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">remove_variation</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionUndo_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
   <span class="k">return</span>
  <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">GameNode</span><span class="p">):</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="n">gameNode</span> <span class="o">=</span> <span class="n">item</span>
   <span class="n">parent</span> <span class="o">=</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">removeGameNode</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">is_mainline</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">removeLastNode</span><span class="p">()</span>
   <span class="n">parent</span><span class="o">.</span><span class="n">remove_variation</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
  <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
   <span class="n">attr</span><span class="p">,</span> <span class="n">gameNodeValueList</span> <span class="o">=</span> <span class="n">item</span>
   <span class="n">gameNode</span> <span class="o">=</span> <span class="n">gameNodeValueList</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
   <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;headers&#39;</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attr</span><span class="p">,</span> <span class="p">(</span><span class="n">gameNode</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">attr</span><span class="p">))))</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">gameNodeValueList</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="n">redoGameNodeValueList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;variations&#39;</span><span class="p">:</span>
     <span class="k">for</span> <span class="n">headParentNode</span><span class="p">,</span> <span class="n">savedVariations</span> <span class="ow">in</span> <span class="n">gameNodeValueList</span><span class="p">:</span>
      <span class="n">redoGameNodeValueList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">headParentNode</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">attr</span><span class="p">)))</span>
      <span class="n">variantDeleted</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">savedVariations</span><span class="p">)</span>
      <span class="n">mainlineChanged</span> <span class="o">=</span> <span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">savedVariations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">promotedToMain</span> <span class="o">=</span> <span class="n">mainlineChanged</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">variantDeleted</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">promotedToMain</span> <span class="ow">or</span> <span class="n">variantDeleted</span><span class="p">):</span>
       <span class="k">for</span> <span class="n">firstId</span><span class="p">,</span> <span class="n">gameNode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">savedVariations</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">[</span><span class="n">firstId</span><span class="p">]</span> <span class="o">!=</span> <span class="n">savedVariations</span><span class="p">[</span><span class="n">firstId</span><span class="p">]:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">moveVariant</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">firstId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
         <span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span> <span class="o">=</span> <span class="n">savedVariations</span>
         <span class="k">break</span>
      <span class="k">else</span><span class="p">:</span>
       <span class="n">gameNode</span><span class="o">.</span><span class="n">variations</span> <span class="o">=</span> <span class="n">savedVariations</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">gameSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;game&#39;</span><span class="p">:</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attr</span><span class="p">,</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">))]))</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">gameNodeValueList</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
     <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">oldAttrValue</span> <span class="ow">in</span> <span class="n">gameNodeValueList</span><span class="p">:</span>
      <span class="n">redoGameNodeValueList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">node</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">attr</span><span class="p">)))</span>
      <span class="nb">setattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">oldAttrValue</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">gameSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attr</span><span class="p">,</span> <span class="n">redoGameNodeValueList</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;UIE: Undo item type </span><span class="si">{}</span><span class="s1"> not expected&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)))</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionRedo_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
   <span class="k">return</span>
  <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">GameNode</span><span class="p">):</span>
   <span class="n">item</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">variations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">newGameNode</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
  <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
   <span class="n">attr</span><span class="p">,</span> <span class="n">gameNodeValueList</span> <span class="o">=</span> <span class="n">item</span>
   <span class="n">gameNode</span> <span class="o">=</span> <span class="n">gameNodeValueList</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
   <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;headers&#39;</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attr</span><span class="p">,</span> <span class="p">(</span><span class="n">gameNode</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">attr</span><span class="p">))))</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">gameNodeValueList</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="n">redoGameNodeValueList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;variations&#39;</span><span class="p">:</span>
     <span class="k">for</span> <span class="n">headParentNode</span><span class="p">,</span> <span class="n">savedVariations</span> <span class="ow">in</span> <span class="n">gameNodeValueList</span><span class="p">:</span>
      <span class="n">redoGameNodeValueList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">headParentNode</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">attr</span><span class="p">)))</span>
      <span class="n">variantDeleted</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">savedVariations</span><span class="p">)</span>
      <span class="n">mainlineChanged</span> <span class="o">=</span> <span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">savedVariations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">promotedToMain</span> <span class="o">=</span> <span class="n">mainlineChanged</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">variantDeleted</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">promotedToMain</span> <span class="ow">or</span> <span class="n">variantDeleted</span><span class="p">):</span>
       <span class="k">for</span> <span class="n">firstId</span><span class="p">,</span> <span class="n">gameNode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">savedVariations</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span><span class="p">[</span><span class="n">firstId</span><span class="p">]</span> <span class="o">!=</span> <span class="n">savedVariations</span><span class="p">[</span><span class="n">firstId</span><span class="p">]:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">moveVariant</span><span class="p">(</span><span class="n">headParentNode</span><span class="p">,</span> <span class="n">firstId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
         <span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span> <span class="o">=</span> <span class="n">savedVariations</span>
         <span class="k">break</span>
      <span class="k">else</span><span class="p">:</span>
       <span class="n">headParentNode</span><span class="o">.</span><span class="n">variations</span> <span class="o">=</span> <span class="n">savedVariations</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
     <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">oldAttrValue</span> <span class="ow">in</span> <span class="n">gameNodeValueList</span><span class="p">:</span>
      <span class="n">redoGameNodeValueList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">node</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">attr</span><span class="p">)))</span>
      <span class="nb">setattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">oldAttrValue</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attr</span><span class="p">,</span> <span class="n">redoGameNodeValueList</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;UIE: Undo item type </span><span class="si">{}</span><span class="s1"> not expected&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)))</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="k">def</span> <span class="nf">setChessWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span> <span class="o">=</span> <span class="kc">False</span> 
  <span class="k">for</span> <span class="n">undoList</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">undoList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span><span class="p">:</span>
    <span class="k">break</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;MzChess - &#39;</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgnFile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="n">title</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pgnFile</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">title</span> <span class="o">+=</span> <span class="s1">&#39;&lt;UNKNOWN&gt;&#39;</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListChanged</span><span class="p">:</span>
   <span class="n">title</span> <span class="o">+=</span> <span class="s1">&#39; *&#39;</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

 <span class="c1"># ---------------------------------------------------------------------------</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuSelectEngine_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="n">oldValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">actAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuSelectEngine</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="n">actAction</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">oldValue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">show_HintsScores</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuSearchDepth_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">actAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuSearchDepth</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="n">actAction</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">tList</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;searchDepth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">tList</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuNumberOfAnnotations_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">actAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBlunderLimit</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="n">actAction</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">naValue</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;numberOfAnnotations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">naValue</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuBlunderLimit_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">actAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBlunderLimit</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="n">actAction</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">blValue</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">blValue</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
   <span class="n">blunderLimit</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">blunderLimit</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">blValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;blunderLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">blunderLimit</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuAnnotateVariants_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">actAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuAnnotateVariants</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="n">actAction</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">avValue</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">avValue</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;annotateVariants&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">avValue</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;annotateVariants&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;annotateVariants&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">avValue</span><span class="p">))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionAnnotateCurrentMove_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;No engine selected&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debugEngine</span><span class="p">:</span>
   <span class="n">logFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logSignal</span><span class="o">.</span><span class="n">emit</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">logFunction</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">engine</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">ChessEngine</span><span class="p">(</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]],</span> 
      <span class="n">limit</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="n">depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;searchDepth&#39;</span><span class="p">]),</span> 
      <span class="n">log</span> <span class="o">=</span> <span class="n">logFunction</span><span class="p">)</span>

  <span class="n">aEngine</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">AnnotateEngine</span><span class="p">(</span><span class="n">notifyFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifySignal</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
  <span class="n">annotateVariants</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;annotateVariants&#39;</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">annotateVariants</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">annotateVariants</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
   <span class="n">annotateVariants</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">annotateVariants</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">annotateVariants</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Scoring move </span><span class="si">{}</span><span class="s1"> of game #</span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">move</span><span class="o">.</span><span class="n">uci</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">))</span>
  <span class="n">aEngine</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">hintPLYs</span> <span class="o">=</span> <span class="n">annotateVariants</span><span class="p">,</span> <span class="n">multiPV</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;numberOfAnnotations&#39;</span><span class="p">]))</span>
  <span class="k">if</span> <span class="n">aEngine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">numberOfPlys</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
   <span class="n">annotator</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">Annotator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">],</span> <span class="n">notifyFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifySignal</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
   <span class="n">annotator</span><span class="o">.</span><span class="n">setBlunder</span><span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">addVariant</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
   <span class="n">oldAttrValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">comment</span>
   <span class="n">annotator</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">game</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">scoreListList</span> <span class="o">=</span> <span class="n">aEngine</span><span class="o">.</span><span class="n">scoreListList</span><span class="p">,</span> <span class="n">pvListList</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">oldAttrValue</span><span class="p">)]))</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="c1"># self.gameHeaderTableView.setGame(self.game)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Annotation failed&#39;</span><span class="p">)</span>
   <span class="k">return</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionAnnotateAll_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;No engine selected&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debugEngine</span><span class="p">:</span>
   <span class="n">logFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logSignal</span><span class="o">.</span><span class="n">emit</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">logFunction</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">engine</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">ChessEngine</span><span class="p">(</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]],</span> 
      <span class="n">limit</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="n">depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;searchDepth&#39;</span><span class="p">]),</span> 
      <span class="n">log</span> <span class="o">=</span> <span class="n">logFunction</span><span class="p">)</span>

  <span class="n">aEngine</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">AnnotateEngine</span><span class="p">(</span><span class="n">notifyFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notifySignal</span><span class="o">.</span><span class="n">emit</span><span class="p">)</span>
  <span class="n">annotateVariants</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;annotateVariants&#39;</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">annotateVariants</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">annotateVariants</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
   <span class="n">annotateVariants</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">annotateVariants</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="n">annotateVariants</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span>
  <span class="k">while</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
   <span class="k">if</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">variations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">gameNode</span><span class="p">:</span>
    <span class="k">break</span>
   <span class="n">gameNode</span> <span class="o">=</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">parent</span>
  <span class="k">if</span> <span class="n">gameNode</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Annotating game #</span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Annotating variant </span><span class="si">{}</span><span class="s1"> of #</span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gameNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">))</span>
  <span class="n">aEngine</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">hintPLYs</span> <span class="o">=</span> <span class="n">annotateVariants</span><span class="p">,</span> <span class="n">multiPV</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;numberOfAnnotations&#39;</span><span class="p">]))</span>
  <span class="k">if</span> <span class="n">aEngine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">numberOfPlys</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
   <span class="n">annotator</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">Annotator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">])</span>
   <span class="n">addVariant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;blunderLimit&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-inf&#39;</span>
   <span class="n">annotator</span><span class="o">.</span><span class="n">setBlunder</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;blunderLimit&#39;</span><span class="p">]),</span> <span class="n">addVariant</span> <span class="o">=</span> <span class="n">addVariant</span><span class="p">)</span>
   <span class="n">undoGameNodeValueList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">actGameNode</span> <span class="ow">in</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">mainline</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">actGameNode</span><span class="o">.</span><span class="n">comment</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
     <span class="n">undoGameNodeValueList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">actGameNode</span><span class="p">,</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">comment</span><span class="p">))</span>
   <span class="n">hintsAdded</span> <span class="o">=</span> <span class="n">annotator</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">game</span> <span class="o">=</span> <span class="n">gameNode</span><span class="p">,</span> <span class="n">scoreListList</span> <span class="o">=</span> <span class="n">aEngine</span><span class="o">.</span><span class="n">scoreListList</span><span class="p">,</span> <span class="n">pvListList</span> <span class="o">=</span> <span class="n">aEngine</span><span class="o">.</span><span class="n">pvListList</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">hintsAdded</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;game&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">))]))</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">undoGameNodeValueList</span><span class="p">)]))</span>
   <span class="k">if</span> <span class="n">gameNode</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="c1"># self.gameHeaderTableView.setGame(self.game)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameNodeSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Annotation failed&#39;</span><span class="p">)</span>
   <span class="k">return</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_actionShowOptions_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setDrawOptions</span><span class="p">(</span><span class="n">checked</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Game&#39;</span><span class="p">][</span><span class="s1">&#39;showOptions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">checked</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_actionWarnOfDanger_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setWarnOfDanger</span><span class="p">(</span><span class="n">checked</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Game&#39;</span><span class="p">][</span><span class="s1">&#39;warnOfDanger&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">checked</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_actionFlipBoard_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setFlipped</span><span class="p">(</span><span class="n">checked</span><span class="p">)</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionSelectHeaderElements_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">headerElements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameHeaderTableView</span><span class="o">.</span><span class="n">headerElements</span><span class="p">(</span><span class="n">withoutSevenTagRoster</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">itemSelector</span><span class="o">.</span><span class="n">setContent</span><span class="p">(</span><span class="n">headerElements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optionalHeaderItems</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemSelector</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
   <span class="k">return</span> <span class="kc">None</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setGameHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemSelector</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span> <span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameHeaderTableView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">updateSettingsList</span><span class="p">(</span><span class="s1">&#39;OptionalHeaderItems&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optionalHeaderItems</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
   
 <span class="k">def</span> <span class="nf">show_HintsScores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;No engine selected&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  
  <span class="n">scoresChecked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionShowScores</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
  <span class="n">hintsChecked</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;showHints&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;showScores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">scoresChecked</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">hintsChecked</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">scoresChecked</span><span class="p">:</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;searchDepth&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;&quot;Engine/Search Depth&quot; undefined.&#39;</span><span class="p">)</span>
    <span class="k">return</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debugEngine</span><span class="p">:</span>
    <span class="n">logFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logSignal</span><span class="o">.</span><span class="n">emit</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="n">logFunction</span> <span class="o">=</span> <span class="kc">None</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">hintEngine</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">ChessEngine</span><span class="p">(</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">]],</span> 
      <span class="n">limit</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="n">depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;searchDepth&#39;</span><span class="p">]),</span> 
      <span class="n">log</span> <span class="o">=</span> <span class="n">logFunction</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setHint</span><span class="p">(</span><span class="n">enableHint</span> <span class="o">=</span> <span class="n">hintsChecked</span><span class="p">,</span> <span class="n">enableScore</span> <span class="o">=</span> <span class="n">scoresChecked</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hintEngine</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">engineLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;selectedEngine&#39;</span><span class="p">])</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">hintEngine</span> <span class="o">=</span> <span class="kc">None</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setHint</span><span class="p">(</span><span class="n">enableHint</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">enableScore</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">engineLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QAction</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_menuShowHints_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">actAction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuShowHints</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
   <span class="n">actAction</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">naValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hintDict</span><span class="p">[</span><span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Menu/Engine&#39;</span><span class="p">][</span><span class="s1">&#39;showHints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">naValue</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">show_HintsScores</span><span class="p">()</span>
    
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_actionShowScores_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">show_HintsScores</span><span class="p">()</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionConfigureEngine_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">configForm</span> <span class="o">=</span> <span class="n">MzChess</span><span class="o">.</span><span class="n">ConfigureEngine</span><span class="p">()</span>
  <span class="n">newEngineDict</span> <span class="o">=</span> <span class="n">configForm</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">engineDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span><span class="p">,</span> <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">debugEngine</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">newEngineDict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span> <span class="o">=</span> <span class="n">newEngineDict</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">resetSelectEngine</span><span class="p">()</span>
   <span class="n">MzChess</span><span class="o">.</span><span class="n">saveEngineSettings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engineDict</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">on_actionDebugEngine_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">debugEngine</span> <span class="o">=</span> <span class="n">checked</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hintEngine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debugEngine</span><span class="p">:</span>
    <span class="n">logFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logSignal</span><span class="o">.</span><span class="n">emit</span>
   <span class="k">else</span><span class="p">:</span>
    <span class="n">logFunction</span> <span class="o">=</span> <span class="kc">None</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">hintEngine</span><span class="o">.</span><span class="n">setLog</span><span class="p">(</span><span class="n">logFunction</span><span class="p">)</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionAbout_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">aboutDialog</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
 
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">on_actionHelp_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">QtGui</span><span class="o">.</span><span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">helpIndex</span><span class="p">)</span>

 <span class="c1"># ---------------------------------------------------------------------------</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span> 
 <span class="k">def</span> <span class="nf">on_actionCopyFEN_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Copying current position of game #</span><span class="si">{}</span><span class="s1"> to clipboard ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">))</span>
  <span class="n">fen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">board</span><span class="p">()</span><span class="o">.</span><span class="n">fen</span><span class="p">()</span>
  <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">clipboard</span><span class="p">()</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fen</span><span class="p">)</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span> 
 <span class="k">def</span> <span class="nf">on_actionPasteFEN_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">fen</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">clipboard</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
  <span class="k">try</span><span class="p">:</span>
   <span class="n">MzChess</span><span class="o">.</span><span class="n">checkFEN</span><span class="p">(</span><span class="n">fen</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Improper FEN </span><span class="si">{}</span><span class="s1">:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fen</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)))</span>
   <span class="k">return</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Pasting position from clipboard to game #</span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">)))</span>
  <span class="n">board</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">Board</span><span class="p">(</span><span class="n">fen</span><span class="p">)</span>
  <span class="n">game</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Game</span><span class="p">()</span>
  <span class="n">game</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span>
  <span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span> 
  <span class="n">game</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
  <span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;SetUp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># remove non-standard header element used by chess package</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_addGame</span><span class="p">(</span><span class="n">game</span><span class="p">)</span> 
 
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span> 
 <span class="k">def</span> <span class="nf">on_actionFENBuilder_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">fenBuilder</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QProcess</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">fenBuilder</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileDirectory</span><span class="p">,</span><span class="s1">&#39;qbuildfen.py&#39;</span><span class="p">)],</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QIODevice</span><span class="o">.</span><span class="n">OpenModeFlag</span><span class="o">.</span><span class="n">NotOpen</span><span class="p">)</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span> 
 <span class="k">def</span> <span class="nf">on_actionCopyGame_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Copying game #</span><span class="si">{}</span><span class="s1"> to clipboard ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">))</span>
  <span class="n">exporter</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">StringExporter</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">variations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">pgnString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">accept</span><span class="p">(</span><span class="n">exporter</span><span class="p">)</span>
  <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">clipboard</span><span class="p">()</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">pgnString</span><span class="p">)</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span> 
 <span class="k">def</span> <span class="nf">on_actionPasteGame_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">pgnString</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">clipboard</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
  <span class="n">pgn</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">pgnString</span><span class="p">)</span>
  <span class="n">game</span> <span class="o">=</span> <span class="n">read_game</span><span class="p">(</span><span class="n">pgn</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;Improper PGN&#39;</span><span class="p">)</span>
   <span class="k">return</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Pasting game from clipboard to game #</span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_addGame</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>
  
 <span class="c1"># ---------------------------------------------------------------------------</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">gameSelected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gameID</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">gameID</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="ow">or</span> <span class="kc">True</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameID</span> <span class="o">=</span> <span class="n">gameID</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameList</span><span class="p">[</span><span class="n">gameID</span><span class="p">]</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s1">&#39;Loading game #</span><span class="si">{}</span><span class="s1"> ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">))</span>
  <span class="k">try</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">_showEcoCode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">fromBeginning</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setGameNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameHeaderTableView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">setGame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setInfoLabel</span><span class="p">()</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">setMoveLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">board</span><span class="p">())</span>
  <span class="k">except</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">notifyError</span><span class="p">(</span><span class="s1">&#39;UIE: Improper game =&quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">))</span>
   <span class="k">return</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">gameListHeaderChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gameListHeader</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameListHeader</span> <span class="o">=</span> <span class="n">gameListHeader</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">updateSettingsList</span><span class="p">(</span><span class="s1">&#39;GameListHeaders&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameListHeader</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
 <span class="k">def</span> <span class="nf">gameListChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setInfoLabel</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Headers</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">gameHeadersChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">headers</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;headers&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">)]))</span>
  <span class="k">if</span> <span class="s1">&#39;Comment&#39;</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Comment&#39;</span><span class="p">]</span>
   <span class="k">del</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Comment&#39;</span><span class="p">]</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;White&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;White&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerList</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">updateSettingsList</span><span class="p">(</span><span class="s1">&#39;Players&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerList</span><span class="p">,</span> <span class="n">firstValue</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;White&quot;</span><span class="p">])</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Black&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Black&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerList</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">updateSettingsList</span><span class="p">(</span><span class="s1">&#39;Players&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">playerList</span><span class="p">,</span> <span class="n">firstValue</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Black&quot;</span><span class="p">])</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Event&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Event&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventList</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">updateSettingsList</span><span class="p">(</span><span class="s1">&#39;Events&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eventList</span><span class="p">,</span> <span class="n">firstValue</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Event&quot;</span><span class="p">])</span>
  <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Site&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Site&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">siteList</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">updateSettingsList</span><span class="p">(</span><span class="s1">&#39;Sites&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">siteList</span><span class="p">,</span> <span class="n">firstValue</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Site&quot;</span><span class="p">])</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">saveSettings</span><span class="p">()</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">GameNode</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">newGameNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gameNode</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="n">gameNode</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">_showEcoCode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">fromBeginning</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">is_mainline</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">addGameNodes</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
   <span class="k">if</span> <span class="s1">&#39;PlyCount&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;PlyCount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">gameNode</span><span class="o">.</span><span class="n">board</span><span class="p">()</span><span class="o">.</span><span class="n">ply</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gameHeaderTableView</span><span class="o">.</span><span class="n">setPlyCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;PlyCount&#39;</span><span class="p">])</span>
   <span class="n">board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">board</span><span class="p">()</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">is_end</span><span class="p">()</span> <span class="ow">and</span> <span class="n">board</span><span class="o">.</span><span class="n">is_game_over</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">board</span><span class="o">.</span><span class="n">is_checkmate</span><span class="p">():</span>
     <span class="k">if</span> <span class="n">board</span><span class="o">.</span><span class="n">turn</span> <span class="o">==</span> <span class="n">chess</span><span class="o">.</span><span class="n">WHITE</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0-1&#39;</span>
     <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1-0&#39;</span>
    <span class="k">else</span><span class="p">:</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1/2-1/2&#39;</span>

  <span class="k">if</span> <span class="n">gameNode</span><span class="o">.</span><span class="n">is_main_variation</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">addGameNodes</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">addVariant</span><span class="p">(</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameChanged</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setMoveLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">board</span><span class="p">())</span>
   
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">GameNode</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">gameNodeSelected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gameNode</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span> <span class="o">=</span> <span class="n">gameNode</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">boardGraphicsView</span><span class="o">.</span><span class="n">setGameNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">is_mainline</span><span class="p">():</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">scorePlotGraphicsView</span><span class="o">.</span><span class="n">selectNodeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setMoveLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gameNode</span><span class="o">.</span><span class="n">board</span><span class="p">())</span>

 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">Game</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">gameChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameHeaderTableView</span><span class="o">.</span><span class="n">setGameResult</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">])</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">gameTreeViewWidget</span><span class="o">.</span><span class="n">setGameResult</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">])</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span>
  
 <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">chess</span><span class="o">.</span><span class="n">pgn</span><span class="o">.</span><span class="n">GameNode</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">gameNodeChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gameNode</span><span class="p">,</span> <span class="n">attrTuple</span><span class="p">):</span>
  <span class="n">attr</span><span class="p">,</span> <span class="n">oldAttrValue</span> <span class="o">=</span> <span class="n">attrTuple</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">undoListList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gameID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attr</span><span class="p">,</span> <span class="p">[(</span><span class="n">gameNode</span><span class="p">,</span> <span class="n">oldAttrValue</span><span class="p">)]))</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">setChessWindowTitle</span><span class="p">()</span></div>

<div class="viewcode-block" id="MzClassApplication"><a class="viewcode-back" href="../chessMainWindow.html#chessMainWindow.MzClassApplication">[docs]</a><span class="k">class</span> <span class="nc">MzClassApplication</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="p">):</span>
 <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argv</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">notifyFct</span> <span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="nb">print</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> 
  <span class="nb">super</span><span class="p">(</span><span class="n">MzClassApplication</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyFct</span> <span class="o">=</span> <span class="n">notifyFct</span>

<div class="viewcode-block" id="MzClassApplication.notify"><a class="viewcode-back" href="../chessMainWindow.html#chessMainWindow.MzClassApplication.notify">[docs]</a> <span class="k">def</span> <span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
  <span class="n">rc</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MzClassApplication</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="n">ev</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">notifyFct</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> -&gt; Type(Event)= </span><span class="si">{}</span><span class="s1">, handled = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="n">ev</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span>  <span class="n">rc</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">rc</span></div></div>

 <span class="c1"># ---------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span>  <span class="nn">os.path</span>

<span class="k">def</span> <span class="nf">runMzChess</span><span class="p">(</span><span class="n">notifyFct</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
 <span class="k">global</span> <span class="n">qApp</span>
 <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">))</span>
 <span class="k">if</span> <span class="n">notifyFct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
  <span class="n">qApp</span> <span class="o">=</span> <span class="n">MzClassApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
 <span class="n">chessMainWindow</span> <span class="o">=</span> <span class="n">ChessMainWindow</span><span class="p">()</span>
 <span class="n">chessMainWindow</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
 <span class="n">chessMainWindow</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
 <span class="n">qApp</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">_runMzChess</span><span class="p">():</span>
 <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello, world&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 <span class="n">runMzChess</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Reinhard März.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>